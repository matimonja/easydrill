import"./modulepreload-polyfill-3cfb730f.js";import{i as u}from"./nav-auth-1aae0094.js";import{initAuth as y,isLoggedIn as E,getProfile as C,fetchWithAuth as x,syncProfile as S,getUserState as I}from"./user-58edc8be.js";import{E as p}from"./ExerciseStorage-321cadc6.js";import"./client-c375c8af.js";const b={free:"Gratuito",basic:"Básico",pro:"Pro",team:"Equipo"};function h(n){return b[n]||n}const c={entrenador:"Entrenador",club:"Coordinador / Club"};async function B(){var m;await y(),u();const n=document.getElementById("perfil-name"),i=document.getElementById("perfil-role"),r=document.getElementById("perfil-bio"),l=document.getElementById("stat-ejercicios"),f=document.getElementById("stat-foros"),d=document.getElementById("stat-forks");if(E()){const t=I(),e=C();if(e&&(n&&(n.textContent=e.displayName||e.email),i&&(i.textContent=c[e.role]||e.role),r&&(r.textContent=e.bio||"Sin presentación aún.")),l){const o=((m=t==null?void 0:t.usage)==null?void 0:m.exercises_saved)??0,a=new p().getExerciseList().length;l.textContent=String(o>0?o:a)}if(t!=null&&t.planId){const o=document.getElementById("perfil-plan");o&&(o.textContent=h(t.planId),o.style.display="inline-block")}const g=document.querySelector(".perfil-edit-link");g&&g.addEventListener("click",async o=>{if(o.preventDefault(),!e)return;const s=e.role==="entrenador"?"club":"entrenador";try{await x("/api/me",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:s})}),await S(),i&&(i.textContent=c[s]||s)}catch(a){console.error("Failed to update role:",a)}})}else{try{const t=localStorage.getItem("easydrill-profile");(t==="entrenador"||t==="club")&&i&&(i.textContent=c[t])}catch{}if(n){const t=localStorage.getItem("easydrill-profile-name");t&&(n.textContent=t)}if(r){const t=localStorage.getItem("easydrill-profile-bio");t&&(r.textContent=t)}if(l){const e=new p().getExerciseList().length;l.textContent=String(e)}if(f){const t=localStorage.getItem("easydrill-stat-foros");f.textContent=t??"0"}if(d){const t=localStorage.getItem("easydrill-stat-forks");d.textContent=t??"0"}}}document.body.classList.contains("perfil-page")&&B();
